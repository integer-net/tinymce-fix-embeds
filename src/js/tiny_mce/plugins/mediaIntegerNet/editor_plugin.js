!function(){var e,t,a=tinymce.explode("id,name,width,height,style,align,class,hspace,vspace,bgcolor,type"),r=tinymce.makeMap(a.join(",")),i=tinymce.html.Node,s=tinymce.util.JSON;function o(e){return"string"==typeof e?e.replace(/[^0-9%]/g,""):e}function c(e){var t,a;if(e&&!e.splice){for(t=[],a=0;e[a];a++)t[a]=e[a];return t}return e}e=[["Flash","d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash","http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"],["ShockWave","166b1bca-3f9c-11cf-8075-444553540000","application/x-director","http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0"],["WindowsMedia","6bf52a52-394a-11d3-b153-00c04f79faa6,22d6f312-b0f6-11d0-94ab-0080c74c7e95,05589fa1-c356-11ce-bf01-00aa0055595a","application/x-mplayer2","http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"],["QuickTime","02bf25d5-8c17-4b23-bc80-d3488abddc6b","video/quicktime","http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"],["RealMedia","cfcdaa03-8be4-11cf-b84b-0020afbbccfa","audio/x-pn-realaudio-plugin","http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"],["Java","8ad9c840-044e-11d1-b3e9-00805f499d93","application/x-java-applet","http://java.sun.com/products/plugin/autodl/jinstall-1_5_0-windows-i586.cab#Version=1,5,0,0"],["Silverlight","dfeaf541-f3e1-4c24-acac-99c30715084a","application/x-silverlight-2"],["Iframe"],["Video"],["EmbeddedAudio"],["Audio"]],tinymce.create("tinymce.plugins.MediaIntegerNetPlugin",{init:function(r,i){var o,c,n,d,m=this,l={};function p(e){return e&&"IMG"===e.nodeName&&r.dom.hasClass(e,"mceItemMedia")}for(m.editor=r,m.url=i,t="",o=0;o<e.length;o++){for(n={name:d=e[o][0],clsids:tinymce.explode(e[o][1]||""),mimes:tinymce.explode(e[o][2]||""),codebase:e[o][3]},c=0;c<n.clsids.length;c++)l["clsid:"+n.clsids[c]]=n;for(c=0;c<n.mimes.length;c++)l[n.mimes[c]]=n;l["mceItem"+d]=n,l[d.toLowerCase()]=n,t+=(t?"|":"")+d}tinymce.each(r.getParam("media_types","video=mp4,m4v,ogv,webm;silverlight=xap;flash=swf,flv;shockwave=dcr;quicktime=mov,qt,mpg,mpeg;shockwave=dcr;windowsmedia=avi,wmv,wm,asf,asx,wmx,wvx;realmedia=rm,ra,ram;java=jar;audio=mp3,ogg").split(";"),function(e){var t,a,r;for(e=e.split(/=/),a=tinymce.explode(e[1].toLowerCase()),t=0;t<a.length;t++)(r=l[e[0].toLowerCase()])&&(l[a[t]]=r)}),t=new RegExp("write("+t+")\\(([^)]+)\\)"),m.lookup=l,r.onPreInit.add(function(){r.schema.addValidElements("object[id|style|width|height|classid|codebase|*],param[name|value],embed[id|style|width|height|type|src|*],video[*],audio[*],source[*]"),r.parser.addNodeFilter("object,embed,video,audio,script,iframe",function(e){for(var t=e.length;t--;)m.objectToImg(e[t])}),r.serializer.addNodeFilter("img",function(e,t,a){for(var r,i=e.length;i--;)-1!==((r=e[i]).attr("class")||"").indexOf("mceItemMedia")&&m.imgToObject(r,a)})}),r.onInit.add(function(){r.theme&&r.theme.onResolveName&&r.theme.onResolveName.add(function(e,t){"img"===t.name&&r.dom.hasClass(t.node,"mceItemMedia")&&(t.name="media")}),r&&r.plugins.contextmenu&&r.plugins.contextmenu.onContextMenu.add(function(e,t,a){"IMG"===a.nodeName&&-1!==a.className.indexOf("mceItemMedia")&&t.add({title:"media.edit",icon:"media",cmd:"mceMedia"})})}),r.addCommand("mceMedia",function(){var e,t;p(t=r.selection.getNode())&&(e=r.dom.getAttrib(t,"data-mce-json"))&&(e=s.parse(e),tinymce.each(a,function(a){var i=r.dom.getAttrib(t,a);i&&(e[a]=i)}),e.type=m.getType(t.className).name.toLowerCase()),e||(e={type:"flash",video:{sources:[]},params:{}}),r.windowManager.open({file:i+"/media.htm",width:430+parseInt(r.getLang("media.delta_width",0)),height:500+parseInt(r.getLang("media.delta_height",0)),inline:1},{plugin_url:i,data:e})}),r.addButton("mediaIntegerNet",{title:"media.desc",cmd:"mceMedia",image:"/js/tiny_mce/plugins/mediaIntegerNet/img/media.gif"}),r.onNodeChange.add(function(e,t,a){t.setActive("mediaIntegerNet",p(a))})},convertUrl:function(e,t){var a=this.editor,r=a.settings,i=r.url_converter,s=r.url_converter_scope||this;return e?t?a.documentBaseURI.toAbsolute(e):i.call(s,e,"src","object"):e},getInfo:function(){return{longname:"Media",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/media",version:tinymce.majorVersion+"."+tinymce.minorVersion}},dataToImg:function(e,t){var a,r,i,n;this.editor.documentBaseURI;if(e.params.src=this.convertUrl(e.params.src,t),(r=e.video.attrs)&&(r.src=this.convertUrl(r.src,t)),r&&(r.poster=this.convertUrl(r.poster,t)),a=c(e.video.sources))for(n=0;n<a.length;n++)a[n].src=this.convertUrl(a[n].src,t);return(i=this.editor.dom.create("img",{id:e.id,style:e.style,align:e.align,hspace:e.hspace,vspace:e.vspace,src:this.editor.theme.url+"/img/trans.gif",class:"mceItemMedia mceItem"+this.getType(e.type).name,"data-mce-json":s.serialize(e,"'")})).width=e.width=o(e.width||("audio"==e.type?"300":"320")),i.height=e.height=o(e.height||("audio"==e.type?"32":"240")),i},dataToHtml:function(e,t){return this.editor.serializer.serialize(this.dataToImg(e,t),{forced_root_block:"",force_absolute:t})},htmlToData:function(e){var t,r,i;return i={type:"flash",video:{sources:[]},params:{}},t=this.editor.parser.parse(e),(r=t.getAll("img")[0])&&((i=s.parse(r.attr("data-mce-json"))).type=this.getType(r.attr("class")).name.toLowerCase(),tinymce.each(a,function(e){var t=r.attr(e);t&&(i[e]=t)})),i},getType:function(e){var t,a,r;for(a=tinymce.explode(e," "),t=0;t<a.length;t++)if(r=this.lookup[a[t]])return r},imgToObject:function(e,t){var r,n,d,m,l,p,h,u,g,f,v,y,w,b,_,x,I=this,j=I.editor;function M(e,t){var a,r,i,s,o;(o=j.getParam("flash_video_player_url",I.convertUrl(I.url+"/moxieplayer.swf")))&&(a=j.documentBaseURI,p.params.src=o,j.getParam("flash_video_player_absvideourl",!0)&&(e=a.toAbsolute(e||"",!0),t=a.toAbsolute(t||"",!0)),i="",r=j.getParam("flash_video_player_flashvars",{url:"$url",poster:"$poster"}),tinymce.each(r,function(a,r){(a=(a=a.replace(/\$url/,e||"")).replace(/\$poster/,t||"")).length>0&&(i+=(i?"&":"")+r+"="+escape(a))}),i.length&&(p.params.flashvars=i),s=j.getParam("flash_video_player_params",{allowfullscreen:!0,allowscriptaccess:!0}),tinymce.each(s,function(e,t){p.params[t]=""+e}))}if(p=e.attr("data-mce-json")){try{p=s.parse(p)}catch(e){return}if(f=this.getType(e.attr("class")),(_=e.attr("data-mce-style"))||(_=e.attr("style"))&&(_=j.dom.serializeStyle(j.dom.parseStyle(_,"img"))),p.width=e.attr("width")||p.width,p.height=e.attr("height")||p.height,"Iframe"===f.name){for(m in w=new i("iframe",1),tinymce.each(a,function(t){var a=e.attr(t);"class"==t&&a&&(a=a.replace(/mceItem.+ ?/g,"")),a&&a.length>0&&w.attr(t,a)}),p.params)w.attr(m,p.params[m]);return w.attr({style:_,src:p.params.src}),void e.replace(w)}if(this.editor.settings.media_use_script)return w=new i("script",1).attr("type","text/javascript"),(l=new i("#text",3)).value="write"+f.name+"("+s.serialize(tinymce.extend(p.params,{width:e.attr("width"),height:e.attr("height")}))+");",w.append(l),void e.replace(w);if("Video"===f.name&&p.video.sources[0]){for(r=new i("video",1).attr(tinymce.extend({id:e.attr("id"),width:o(e.attr("width")),height:o(e.attr("height")),style:_},p.video.attrs)),p.video.attrs&&(b=p.video.attrs.poster),u=p.video.sources=c(p.video.sources),v=0;v<u.length;v++)/\.mp4$/.test(u[v].src)&&(y=u[v].src);for(u[0].type||(r.attr("src",u[0].src),u.splice(0,1)),v=0;v<u.length;v++)(h=new i("source",1).attr(u[v])).shortEnded=!0,r.append(h);y?(M(y,b),f=I.getType("flash")):p.params.src=""}if("Audio"===f.name&&p.video.sources[0]){for(x=new i("audio",1).attr(tinymce.extend({id:e.attr("id"),width:o(e.attr("width")),height:o(e.attr("height")),style:_},p.video.attrs)),p.video.attrs&&(b=p.video.attrs.poster),(u=p.video.sources=c(p.video.sources))[0].type||(x.attr("src",u[0].src),u.splice(0,1)),v=0;v<u.length;v++)(h=new i("source",1).attr(u[v])).shortEnded=!0,x.append(h);p.params.src=""}if("EmbeddedAudio"===f.name){for(m in(d=new i("embed",1)).shortEnded=!0,d.attr({id:e.attr("id"),width:o(e.attr("width")),height:o(e.attr("height")),style:_,type:e.attr("type")}),p.params)d.attr(m,p.params[m]);tinymce.each(a,function(e){p[e]&&"type"!=e&&d.attr(e,p[e])}),p.params.src=""}if(p.params.src){for(m in/\.flv$/i.test(p.params.src)&&M(p.params.src,""),t&&t.force_absolute&&(p.params.src=j.documentBaseURI.toAbsolute(p.params.src)),n=new i("object",1).attr({id:e.attr("id"),width:o(e.attr("width")),height:o(e.attr("height")),style:_}),tinymce.each(a,function(e){var t=p[e];"class"==e&&t&&(t=t.replace(/mceItem.+ ?/g,"")),t&&"type"!=e&&n.attr(e,t)}),p.params)(g=new i("param",1)).shortEnded=!0,l=p.params[m],"src"===m&&"WindowsMedia"===f.name&&(m="url"),g.attr({name:m,value:l}),n.append(g);if(this.editor.getParam("media_strict",!0))n.attr({data:p.params.src,type:f.mimes[0]});else{for(m in n.attr({classid:"clsid:"+f.clsids[0],codebase:f.codebase}),(d=new i("embed",1)).shortEnded=!0,d.attr({id:e.attr("id"),width:o(e.attr("width")),height:o(e.attr("height")),style:_,type:f.mimes[0]}),p.params)d.attr(m,p.params[m]);tinymce.each(a,function(e){p[e]&&"type"!=e&&d.attr(e,p[e])}),n.append(d)}p.object_html&&((l=new i("#text",3)).raw=!0,l.value=p.object_html,n.append(l)),r&&r.append(n)}r&&p.video_html&&((l=new i("#text",3)).raw=!0,l.value=p.video_html,r.append(l)),x&&p.video_html&&((l=new i("#text",3)).raw=!0,l.value=p.video_html,x.append(l));var A=r||x||n||d;A?e.replace(A):e.remove()}},objectToImg:function(e){var c,n,d,m,l,p,h,u,g,f,v,y,w,b,_,x,I,j,M,A,N,k,T,C,E=this.lookup,P=this.editor.settings.url_converter,U=this.editor.settings.url_converter_scope;function z(e){return new tinymce.html.Serializer({inner:!0,validate:!1}).serialize(e)}function L(e,t){return E[(e.attr(t)||"").toLowerCase()]}if(e.parent){if("script"===e.name){if(e.firstChild&&(M=t.exec(e.firstChild.value)),!M)return;j=M[1],u=(I={video:{},params:s.parse(M[2])}).params.width,g=I.params.height}if(I=I||{video:{},params:{}},(l=new i("img",1)).attr({src:this.editor.theme.url+"/img/trans.gif"}),"video"===(p=e.name)||"audio"==p){for(p in d=e,c=e.getAll("object")[0],n=e.getAll("embed")[0],u=d.attr("width"),g=d.attr("height"),h=d.attr("id"),I.video={attrs:{},sources:[]},A=I.video.attrs,d.attributes.map)A[p]=d.attributes.map[p];for((_=e.attr("src"))&&I.video.sources.push({src:P.call(U,_,"src",e.name)}),x=d.getAll("source"),v=0;v<x.length;v++)_=x[v].remove(),I.video.sources.push({src:P.call(U,_.attr("src"),"src","source"),type:_.attr("type"),media:_.attr("media")});A.poster&&(A.poster=P.call(U,A.poster,"poster",e.name))}if("object"===e.name&&(c=e,n=e.getAll("embed")[0]),"embed"===e.name&&(n=e),"iframe"===e.name&&(m=e,j="Iframe"),c){for(u=u||c.attr("width"),g=g||c.attr("height"),f=f||c.attr("style"),h=h||c.attr("id"),N=N||c.attr("hspace"),k=k||c.attr("vspace"),T=T||c.attr("align"),C=C||c.attr("bgcolor"),I.name=c.attr("name"),b=c.getAll("param"),v=0;v<b.length;v++)p=(w=b[v]).remove().attr("name"),r[p]||(I.params[p]=w.attr("value"));I.params.src=I.params.src||c.attr("data")}if(n)for(p in u=u||n.attr("width"),g=g||n.attr("height"),f=f||n.attr("style"),h=h||n.attr("id"),N=N||n.attr("hspace"),k=k||n.attr("vspace"),T=T||n.attr("align"),C=C||n.attr("bgcolor"),n.attributes.map)r[p]||I.params[p]||(I.params[p]=n.attributes.map[p]);if(m)for(p in u=o(m.attr("width")),g=o(m.attr("height")),f=f||m.attr("style"),h=m.attr("id"),N=m.attr("hspace"),k=m.attr("vspace"),T=m.attr("align"),C=m.attr("bgcolor"),tinymce.each(a,function(e){l.attr(e,m.attr(e))}),m.attributes.map)r[p]||I.params[p]||(I.params[p]=m.attributes.map[p]);var R,$;I.params.movie&&(I.params.src=I.params.src||I.params.movie,delete I.params.movie),I.params.src&&(I.params.src=P.call(U,I.params.src,"src","object")),d&&("video"===e.name?j=E.video.name:"audio"===e.name&&(j=E.audio.name)),c&&!j&&(j=(L(c,"clsid")||L(c,"classid")||L(c,"type")||{}).name),n&&!j&&(j=(L(n,"type")||(R=I.params.src,$=R.replace(/^.*\.([^.]+)$/,"$1"),E[$.toLowerCase()||""])||{}).name),n&&"EmbeddedAudio"==j&&(I.params.type=n.attr("type")),e.replace(l),n&&n.remove(),c&&(y=z(c.remove()))&&(I.object_html=y),d&&(y=z(d.remove()))&&(I.video_html=y),I.hspace=N,I.vspace=k,I.align=T,I.bgcolor=C,l.attr({id:h,class:"mceItemMedia mceItem"+(j||"Flash"),style:f,width:u||("audio"==e.name?"300":"320"),height:g||("audio"==e.name?"32":"240"),hspace:N,vspace:k,align:T,bgcolor:C,"data-mce-json":s.serialize(I,"'")})}}}),tinymce.PluginManager.add("mediaIntegerNet",tinymce.plugins.MediaIntegerNetPlugin)}();